{% extends 'lungcancer/base.html' %}

{% block title %}예측 결과 - 폐암 예측 시스템{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="text-center mb-4">
            <h2 class="fw-bold">
                <i class="bi bi-clipboard-check text-success"></i> 예측 결과
            </h2>
            <p class="text-muted">환자 #{{ patient.id }}의 폐암 예측 결과입니다</p>
        </div>

        <!-- 예측 결과 카드 -->
        <div class="card border-{{ risk_color }} mb-4">
            <div class="card-header bg-{{ risk_color }} text-white text-center py-3">
                <h4 class="mb-0">
                    {% if patient.prediction == 'YES' %}
                        <i class="bi bi-exclamation-triangle-fill"></i> 폐암 양성
                    {% else %}
                        <i class="bi bi-check-circle-fill"></i> 폐암 음성
                    {% endif %}
                </h4>
            </div>
            <div class="card-body p-4">
                <div class="text-center mb-4">
                    <h1 class="display-3 {% if patient.prediction == 'YES' %}text-danger{% else %}text-info{% endif %} mb-3">{{ probability_percent }}%</h1>
                    <h5 class="text-muted">폐암 발병 위험도</h5>
                    <div class="progress mt-3" style="height: 30px;">
                        <div class="progress-bar {% if patient.prediction == 'YES' %}bg-danger{% else %}bg-success{% endif %}" role="progressbar" 
                             style="width: {{ probability_percent }}%">
                            {{ probability_percent }}%
                        </div>
                    </div>
                </div>

                <div class="alert alert-{{ risk_color }} mt-4">
                    <h5 class="alert-heading">
                        <i class="bi bi-info-circle"></i> 위험도: {{ risk_level }}
                    </h5>
                    <p class="mb-0">{{ risk_message }}</p>
                </div>
            </div>
        </div>

        <!-- 환자 정보 -->
        <div class="card mb-4">
            <div class="card-header bg-light">
                <h5 class="mb-0"><i class="bi bi-person-badge"></i> 환자 정보</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>성별:</strong> {% if patient.gender == 1 %}남성{% else %}여성{% endif %}</p>
                        <p><strong>나이:</strong> {{ patient.age }}세</p>
                        <p><strong>흡연:</strong> {% if patient.smoking == 2 %}예{% else %}아니오{% endif %}</p>
                        <p><strong>음주:</strong> {% if patient.alcohol_consuming == 2 %}예{% else %}아니오{% endif %}</p>
                        <p><strong>만성 질환:</strong> {% if patient.chronic_disease == 2 %}예{% else %}아니오{% endif %}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>기침:</strong> {% if patient.coughing == 2 %}예{% else %}아니오{% endif %}</p>
                        <p><strong>호흡 곤란:</strong> {% if patient.shortness_of_breath == 2 %}예{% else %}아니오{% endif %}</p>
                        <p><strong>가슴 통증:</strong> {% if patient.chest_pain == 2 %}예{% else %}아니오{% endif %}</p>
                        <p><strong>피로:</strong> {% if patient.fatigue == 2 %}예{% else %}아니오{% endif %}</p>
                        <p><strong>쌕쌕거림:</strong> {% if patient.wheezing == 2 %}예{% else %}아니오{% endif %}</p>
                    </div>
                </div>
                <hr>
                <p class="text-muted mb-0">
                    <i class="bi bi-clock"></i> 예측 시간: {{ patient.created_at|date:"Y년 m월 d일 H:i" }}
                </p>
            </div>
        </div>

        <!-- 액션 버튼 -->
        <div class="text-center">
            <a href="{% url 'lungcancer:patient_detail' patient.id %}" class="btn btn-info btn-lg">
                <i class="bi bi-eye"></i> 상세 보기
            </a>
            <a href="{% url 'lungcancer:predict' %}" class="btn btn-primary btn-lg">
                <i class="bi bi-plus-circle"></i> 새 예측
            </a>
            <a href="{% url 'lungcancer:patient_list' %}" class="btn btn-secondary btn-lg">
                <i class="bi bi-list"></i> 환자 목록
            </a>
            <a href="{% url 'lungcancer:home' %}" class="btn btn-outline-secondary btn-lg">
                <i class="bi bi-house"></i> 홈으로
            </a>
        </div>
    </div>
</div>

<style>
    .progress {
        border-radius: 15px;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
    }
    
    .progress-bar {
        border-radius: 15px;
        font-weight: bold;
        font-size: 1.1rem;
    }
</style>
{% endblock %}

